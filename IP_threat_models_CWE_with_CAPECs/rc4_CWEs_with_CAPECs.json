{
  "IP": "rc4",
  "Assets": [
    {
      "Asset_Name": "Key/password input byte port (password_input)",
      "Functionality": "Feeds key bytes into the module during KSS_KEYREAD; each byte is stored into key[i] and later used in key scheduling.",
      "Security Objective": "Confidentiality, Integrity",
      "Justification": "This port carries secret key material; disclosure compromises the secrecy of the keystream and any protected data. Unauthorized modification of these bytes changes the derived permutation and keystream, violating the intended cryptographic behavior.",
      "CWE-IDs": [
        "CWE-1271",
        "CWE-1233",
        "CWE-1234"
      ],
      "Justification of Related CWE-IDs": {
        "CWE-1271": "The rc4 module's password_input port could be vulnerable if the key registers are not properly initialized on reset, potentially exposing the secret key material to unauthorized access.",
        "CWE-1233": "The absence of lock bit protection on the password_input port could allow unauthorized modification of the key bytes, compromising the confidentiality and integrity of the keystream.",
        "CWE-1234": "If the rc4 module allows debug modes to override locks on the password_input port, it could lead to unauthorized changes to the key material, violating the intended cryptographic behavior."
      },
      "CAPEC-Mapping-Per-CWE": {
        "CWE-1271": {
          "CAPEC-IDs": [
            "CAPEC-74",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-74": "CAPEC-74 exploits CWE-1271 by intercepting and manipulating the password_input port during the KSS_KEYREAD state, compromising the confidentiality and integrity of the key material and resulting keystream.",
            "CAPEC-150": "CAPEC-150 leverages CWE-1271 by injecting malicious data into the password_input port, altering the key scheduling process and undermining the confidentiality and integrity of the cryptographic output."
          }
        },
        "CWE-1233": {
          "CAPEC-IDs": [
            "CAPEC-176",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-176": "CAPEC-176 exploits CWE-1233 by intercepting the password_input port to disclose or alter key bytes, compromising the confidentiality and integrity of the keystream generated by the rc4 module.",
            "CAPEC-150": "CAPEC-150 leverages CWE-1233 by manipulating the password_input during the KSS_KEYREAD state to inject unauthorized key bytes, undermining the integrity of the key scheduling process and the resulting keystream."
          }
        },
        "CWE-1234": {
          "CAPEC-IDs": [
            "CAPEC-176",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-176": "CAPEC-176 could exploit CWE CWE-1234 by intercepting and altering the password_input bytes during the KSS_KEYREAD state, compromising the confidentiality and integrity of the key material and resulting keystream.",
            "CAPEC-150": "CAPEC-150 could exploit CWE CWE-1234 by injecting malicious data into the password_input port, leading to unauthorized modification of the key scheduling process and violating the intended cryptographic behavior."
          }
        }
      },
      "CAPEC-IDs": [
        "CAPEC-74",
        "CAPEC-150",
        "CAPEC-176"
      ],
      "Justification of Related CAPEC-IDs": {
        "CAPEC-74": "[CWE-1271] CAPEC-74 exploits CWE-1271 by intercepting and manipulating the password_input port during the KSS_KEYREAD state, compromising the confidentiality and integrity of the key material and resulting keystream.",
        "CAPEC-150": "[CWE-1271] CAPEC-150 leverages CWE-1271 by injecting malicious data into the password_input port, altering the key scheduling process and undermining the confidentiality and integrity of the cryptographic output. [CWE-1233] CAPEC-150 leverages CWE-1233 by manipulating the password_input during the KSS_KEYREAD state to inject unauthorized key bytes, undermining the integrity of the key scheduling process and the resulting keystream. [CWE-1234] CAPEC-150 could exploit CWE CWE-1234 by injecting malicious data into the password_input port, leading to unauthorized modification of the key scheduling process and violating the intended cryptographic behavior.",
        "CAPEC-176": "[CWE-1233] CAPEC-176 exploits CWE-1233 by intercepting the password_input port to disclose or alter key bytes, compromising the confidentiality and integrity of the keystream generated by the rc4 module. [CWE-1234] CAPEC-176 could exploit CWE CWE-1234 by intercepting and altering the password_input bytes during the KSS_KEYREAD state, compromising the confidentiality and integrity of the key material and resulting keystream."
      }
    },
    {
      "Asset_Name": "Stored key array (key)",
      "Functionality": "Holds the collected key bytes which are referenced during KSS_KEYSCHED2 to compute j and permute S.",
      "Security Objective": "Confidentiality, Integrity",
      "Justification": "The array contains the secret key and must not be exposed. Any corruption would alter the S permutation and therefore the keystream, undermining correctness and security.",
      "CWE-IDs": [
        "CWE-1271",
        "CWE-1233",
        "CWE-1231"
      ],
      "Justification of Related CWE-IDs": {
        "CWE-1271": "The stored key array may not be initialized to a secure state on reset, potentially exposing the secret key to unauthorized access.",
        "CWE-1233": "The lack of lock bit protection on the key array could allow unauthorized modification of the key, compromising the integrity of the keystream.",
        "CWE-1231": "If lock bits for the key array can be modified after initialization, it could lead to unauthorized changes to the key, affecting confidentiality and integrity."
      },
      "CAPEC-Mapping-Per-CWE": {
        "CWE-1271": {
          "CAPEC-IDs": [
            "CAPEC-74",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-74": "CAPEC-74 exploits CWE-1271 by manipulating the finite state machine transitions to improperly access or modify the stored key array, compromising its confidentiality and integrity during the key scheduling phase.",
            "CAPEC-150": "CAPEC-150 targets CWE-1271 by injecting malicious inputs through the password_input interface, potentially leading to unauthorized access or alteration of the stored key array, thereby violating its confidentiality and integrity."
          }
        },
        "CWE-1233": {
          "CAPEC-IDs": [
            "CAPEC-176",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-176": "CAPEC-176 can exploit CWE-1233 by manipulating the finite state machine transitions to improperly access or alter the stored key array, compromising its confidentiality and integrity during the KSS_KEYSCHED2 phase.",
            "CAPEC-150": "CAPEC-150 targets CWE-1233 by inducing faults in the key scheduling process, potentially leading to unauthorized access or corruption of the stored key array, thereby violating its confidentiality and integrity."
          }
        },
        "CWE-1231": {
          "CAPEC-IDs": [
            "CAPEC-680",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-680": "CAPEC-680 could exploit CWE-1231 by manipulating the finite state machine transitions to improperly handle the stored key array, compromising the confidentiality and integrity of the key during the KSS_KEYSCHED2 phase.",
            "CAPEC-150": "CAPEC-150 could exploit CWE-1231 by inducing incorrect state transitions in the FSM, leading to unauthorized access or modification of the stored key array, thereby violating its confidentiality and integrity."
          }
        }
      },
      "CAPEC-IDs": [
        "CAPEC-74",
        "CAPEC-150",
        "CAPEC-176",
        "CAPEC-680"
      ],
      "Justification of Related CAPEC-IDs": {
        "CAPEC-74": "[CWE-1271] CAPEC-74 exploits CWE-1271 by manipulating the finite state machine transitions to improperly access or modify the stored key array, compromising its confidentiality and integrity during the key scheduling phase.",
        "CAPEC-150": "[CWE-1271] CAPEC-150 targets CWE-1271 by injecting malicious inputs through the password_input interface, potentially leading to unauthorized access or alteration of the stored key array, thereby violating its confidentiality and integrity. [CWE-1233] CAPEC-150 targets CWE-1233 by inducing faults in the key scheduling process, potentially leading to unauthorized access or corruption of the stored key array, thereby violating its confidentiality and integrity. [CWE-1231] CAPEC-150 could exploit CWE-1231 by inducing incorrect state transitions in the FSM, leading to unauthorized access or modification of the stored key array, thereby violating its confidentiality and integrity.",
        "CAPEC-176": "[CWE-1233] CAPEC-176 can exploit CWE-1233 by manipulating the finite state machine transitions to improperly access or alter the stored key array, compromising its confidentiality and integrity during the KSS_KEYSCHED2 phase.",
        "CAPEC-680": "[CWE-1231] CAPEC-680 could exploit CWE-1231 by manipulating the finite state machine transitions to improperly handle the stored key array, compromising the confidentiality and integrity of the key during the KSS_KEYSCHED2 phase."
      }
    },
    {
      "Asset_Name": "Keystream output byte (K)",
      "Functionality": "Provides the generated keystream byte once output_ready is asserted after the initial discard period.",
      "Security Objective": "Confidentiality, Availability",
      "Justification": "The keystream is sensitive cryptographic material; exposure enables recovery of plaintext if ciphertext is known. It is also the primary data output whose disruption or suppression would deny encryption/decryption service.",
      "CWE-IDs": [
        "CWE-1271",
        "CWE-1233",
        "CWE-1223"
      ],
      "Justification of Related CWE-IDs": {
        "CWE-1271": "The keystream output byte (K) could be exposed if registers are not initialized securely on reset, potentially allowing unauthorized access to cryptographic material.",
        "CWE-1233": "Without lock bit protection, the keystream output byte (K) could be modified or accessed by unauthorized entities, compromising confidentiality and availability.",
        "CWE-1223": "A race condition could allow unauthorized access to the keystream output byte (K) before trusted components secure it, leading to potential exposure of sensitive data."
      },
      "CAPEC-Mapping-Per-CWE": {
        "CWE-1271": {
          "CAPEC-IDs": [
            "CAPEC-74",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-74": "CAPEC-74 exploits CWE-1271 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality.",
            "CAPEC-150": "CAPEC-150 targets CWE-1271 by inducing faults in the key scheduling state machine, causing incorrect keystream generation that disrupts the availability of the encryption service by providing invalid keystream bytes."
          }
        },
        "CWE-1233": {
          "CAPEC-IDs": [
            "CAPEC-176",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-176": "CAPEC-176 can exploit CWE-1233 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality.",
            "CAPEC-150": "CAPEC-150 could exploit CWE-1233 by inducing faults in the FSM's state transitions, leading to incorrect keystream generation or suppression, thereby affecting the availability of the keystream output byte (K) for encryption/decryption."
          }
        },
        "CWE-1223": {
          "CAPEC-IDs": [
            "CAPEC-26",
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-26": "CAPEC-26 exploits CWE-1223 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality.",
            "CAPEC-150": "CAPEC-150 leverages CWE-1223 by inducing faults in the FSM's state transitions during keystream generation, leading to incorrect or suppressed keystream output (K), thereby affecting both the confidentiality and availability of the encryption service."
          }
        }
      },
      "CAPEC-IDs": [
        "CAPEC-74",
        "CAPEC-150",
        "CAPEC-176",
        "CAPEC-26"
      ],
      "Justification of Related CAPEC-IDs": {
        "CAPEC-74": "[CWE-1271] CAPEC-74 exploits CWE-1271 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality.",
        "CAPEC-150": "[CWE-1271] CAPEC-150 targets CWE-1271 by inducing faults in the key scheduling state machine, causing incorrect keystream generation that disrupts the availability of the encryption service by providing invalid keystream bytes. [CWE-1233] CAPEC-150 could exploit CWE-1233 by inducing faults in the FSM's state transitions, leading to incorrect keystream generation or suppression, thereby affecting the availability of the keystream output byte (K) for encryption/decryption. [CWE-1223] CAPEC-150 leverages CWE-1223 by inducing faults in the FSM's state transitions during keystream generation, leading to incorrect or suppressed keystream output (K), thereby affecting both the confidentiality and availability of the encryption service.",
        "CAPEC-176": "[CWE-1233] CAPEC-176 can exploit CWE-1233 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality.",
        "CAPEC-26": "[CWE-1223] CAPEC-26 exploits CWE-1223 by manipulating the finite state machine transitions to prematurely assert output_ready, potentially exposing the keystream byte (K) before the initial discard period, thus compromising confidentiality."
      }
    },
    {
      "Asset_Name": "Output valid/ready indicator (output_ready)",
      "Functionality": "Indicates that K is valid for consumption after discarding the first 1536 keystream bytes.",
      "Security Objective": "Availability",
      "Justification": "This handshake governs when downstream logic can safely consume K; if it is suppressed or asserted incorrectly, consumers may stall or process invalid bytes, amounting to denial-of-service or loss of operability.",
      "CWE-IDs": [
        "CWE-1276",
        "CWE-1245",
        "CWE-440"
      ],
      "Justification of Related CWE-IDs": {
        "CWE-1276": "Incorrect connections between the rc4 module and its parent system could lead to the output_ready signal being improperly asserted or suppressed, causing denial of service.",
        "CWE-1245": "Improper FSM transitions in the rc4 module could result in incorrect signaling of the output_ready state, leading to availability issues.",
        "CWE-440": "Deviations from expected behavior in the rc4 module could cause the output_ready signal to be asserted at incorrect times, resulting in downstream logic processing invalid data."
      },
      "CAPEC-Mapping-Per-CWE": {
        "CWE-1276": {
          "CAPEC-IDs": [
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-150": "CAPEC-150 can exploit CWE-1276 by manipulating the finite state machine transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator."
          }
        },
        "CWE-1245": {
          "CAPEC-IDs": [
            "CAPEC-74"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-74": "CAPEC-74 can exploit CWE-1245 by manipulating the finite state machine transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator."
          }
        },
        "CWE-440": {
          "CAPEC-IDs": [
            "CAPEC-150"
          ],
          "Justification of Related CAPEC-IDs": {
            "CAPEC-150": "CAPEC-150 can exploit CWE-440 by manipulating the rc4 module's state transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator."
          }
        }
      },
      "CAPEC-IDs": [
        "CAPEC-150",
        "CAPEC-74"
      ],
      "Justification of Related CAPEC-IDs": {
        "CAPEC-150": "[CWE-1276] CAPEC-150 can exploit CWE-1276 by manipulating the finite state machine transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator. [CWE-440] CAPEC-150 can exploit CWE-440 by manipulating the rc4 module's state transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator.",
        "CAPEC-74": "[CWE-1245] CAPEC-74 can exploit CWE-1245 by manipulating the finite state machine transitions to incorrectly assert the output_ready signal, leading to a denial-of-service by causing downstream logic to process invalid keystream bytes, thus compromising the availability of the output valid/ready indicator."
      }
    }
  ]
}